{"title":"JS DOM标准事件的三个阶段","uid":"5de1032283da4a68ad814ae1c25fb259","slug":"JS-DOM标准事件的三个阶段","date":"2014-08-22T03:29:30.000Z","updated":"2021-04-06T09:12:38.145Z","comments":true,"path":"api/articles/JS-DOM标准事件的三个阶段.json","cover":[],"content":"<p>#事件阶段1（Event Phases）<br>当一个DOM事件呗触发时，它不是在触发的对象上只触发一次的，而是经历三个阶段。分别为1：一开始从文档的根节点流向目标对象（捕获阶段），2：然后在目标对向上被触发（目标阶段），3：之后再回溯到文档的根节点（冒泡阶段）.<br>如图：<br><img src=\"/post/JS-DOM%E6%A0%87%E5%87%86%E4%BA%8B%E4%BB%B6%E7%9A%84%E4%B8%89%E4%B8%AA%E9%98%B6%E6%AE%B5/eventflow.png\"></p>\n<p style=\"text-align: center\">（图片来源：<a href=\"http://www.w3.org/TR/DOM-Level-3-Events/#event-flow\" target=\"_blank\">W3C</a>）</p>\n##事件捕获（Capture Phase）\n事件的第一个阶段是捕获阶段。事件从文档的根节点出发，随着DOM树的结构向事件的目标节点流去。途中经过各个层次的DOM节点，并在各节点上触发捕获事件，直到到达事件的目标节点。捕获阶段的主要任务是建立传播路径，在冒泡阶段，事件会通过这个路径回溯到文档跟节点。\n上几张简单代码图\n将addEventListener(‘event-name’, ‘callback’, ‘use-capture’) 第三个参数，设置为true，让函数在捕获阶段触发\n\n<p><img src=\"/post/JS-DOM%E6%A0%87%E5%87%86%E4%BA%8B%E4%BB%B6%E7%9A%84%E4%B8%89%E4%B8%AA%E9%98%B6%E6%AE%B5/eventP1.png\"><br>点击box1，触发顺序为 到达了 冒泡中<br><img src=\"/post/JS-DOM%E6%A0%87%E5%87%86%E4%BA%8B%E4%BB%B6%E7%9A%84%E4%B8%89%E4%B8%AA%E9%98%B6%E6%AE%B5/enentP2.png\"><br>##事件冒泡（Bubble Phase）<br>事件在目标元素上触发后，并不在这个元素上终止。它会随着DOM树一层层向上冒泡，直到到达最外层的根节点。也就是说，同一个事件会依次在目标节点的父节点，父节点的父节点。直到最外层的节点上被触发。<br>上几张简单代码图<br>将第三个参数改为false<br><img src=\"/post/JS-DOM%E6%A0%87%E5%87%86%E4%BA%8B%E4%BB%B6%E7%9A%84%E4%B8%89%E4%B8%AA%E9%98%B6%E6%AE%B5/eventP3.png\"><br>点击box1，触发顺序为 冒泡中 到达了<br><img src=\"/post/JS-DOM%E6%A0%87%E5%87%86%E4%BA%8B%E4%BB%B6%E7%9A%84%E4%B8%89%E4%B8%AA%E9%98%B6%E6%AE%B5/enentP4.png\"></p>\n<p>如果box2里面在套一个box3，触发顺序又会怎样呢？多试试几次就知道了。<br><img src=\"/post/JS-DOM%E6%A0%87%E5%87%86%E4%BA%8B%E4%BB%B6%E7%9A%84%E4%B8%89%E4%B8%AA%E9%98%B6%E6%AE%B5/eventP5.png\"><br><img src=\"/post/JS-DOM%E6%A0%87%E5%87%86%E4%BA%8B%E4%BB%B6%E7%9A%84%E4%B8%89%E4%B8%AA%E9%98%B6%E6%AE%B5/eventP6.png\"><br>box2的事件第三个参数改为false<br><img src=\"/post/JS-DOM%E6%A0%87%E5%87%86%E4%BA%8B%E4%BB%B6%E7%9A%84%E4%B8%89%E4%B8%AA%E9%98%B6%E6%AE%B5/eventP7.png\"><br>3个事件监听第三个参数都改为false<br><img src=\"/post/JS-DOM%E6%A0%87%E5%87%86%E4%BA%8B%E4%BB%B6%E7%9A%84%E4%B8%89%E4%B8%AA%E9%98%B6%E6%AE%B5/eventP8.png\"><br>现在可以得出一个结论：<br>1:true 的触发顺序总是在 false 之前；2:如果多个均为 true，则外层的触发先于内层；3:如果多个均为 false，则内层的触发先于外层。</p>\n<p>##阻止事件冒泡（Stopping Propagation）<br>可以通过调用事件对象的stopPropagation方法，在任何阶段（捕获阶段或者冒泡阶段）中断事件的传播。此后，事件不会在后面传播过程中的经过的节点上调用任何的监听函数。<br><img src=\"/post/JS-DOM%E6%A0%87%E5%87%86%E4%BA%8B%E4%BB%B6%E7%9A%84%E4%B8%89%E4%B8%AA%E9%98%B6%E6%AE%B5/eventP9.png\"><br>现在点击box  只会触发box3的点击事件了。<br><img src=\"/post/JS-DOM%E6%A0%87%E5%87%86%E4%BA%8B%E4%BB%B6%E7%9A%84%E4%B8%89%E4%B8%AA%E9%98%B6%E6%AE%B5/eventP10.png\"></p>\n","feature":null,"text":"#事件阶段1（Event Phases）当一个DOM事件呗触发时，它不是在触发的对象上只触发一次的，而是经历三个阶段。分别为1：一开始从文档的根节点流向目标对象（捕获阶段），2：然后在目标对向上被触发（目标阶段），3：之后再回溯到文档的根节点（冒泡阶段）.如图： （图片来源：W3...","link":"","photos":[],"count_time":{"symbolsCount":868,"symbolsTime":"1 mins."},"categories":[{"name":"技术","slug":"技术","count":7,"path":"api/categories/技术.json"}],"tags":[{"name":"JS DOM","slug":"JS-DOM","count":3,"path":"api/tags/JS-DOM.json"}],"toc":"","author":{"name":"Lu-ckYoung","avatar":"https://JS-DOM标准事件的三个阶段-blog.csdnimg.cn/20210313122054101.png","link":""},"mapped":true,"prev_post":{"title":"JS clientX,offsetX,screenX,PageX","uid":"05b5d7864f9e3058e6a04eb42e9cfd12","slug":"JS-clientX-offsetX-screenX-PageX","date":"2014-09-10T07:36:26.000Z","updated":"2015-08-06T11:09:37.000Z","comments":true,"path":"api/articles/JS-clientX-offsetX-screenX-PageX.json","cover":[],"text":"event对象是JavaScript中最重要的对象之一，他代表了各种事件的状态，在各种事件的事件处理中经常用到。 用js做拖拽、弹出层、什么之类的少不了用到js的event对象计算位置什么的。先来说说##screenX看看官方解释：screenX 事件属性可返回事件发生时鼠标指针...","link":"","photos":[],"count_time":{"symbolsCount":551,"symbolsTime":"1 mins."},"categories":[{"name":"技术","slug":"技术","count":7,"path":"api/categories/技术.json"}],"tags":[{"name":"JS DOM Event","slug":"JS-DOM-Event","count":1,"path":"api/tags/JS-DOM-Event.json"}],"author":{"name":"Lu-ckYoung","avatar":"https://JS-DOM标准事件的三个阶段-blog.csdnimg.cn/20210313122054101.png","link":""}},"next_post":{"title":"JS拖放元素实例","uid":"b173c4f9e5cd10dcea20e20af9d5faca","slug":"JS拖放元素实例","date":"2014-07-04T08:18:53.000Z","updated":"2015-06-24T01:43:11.000Z","comments":true,"path":"api/articles/JS拖放元素实例.json","cover":null,"text":"结合网上例子加Javascript 权威指南第6版 做得DEMO。考了了IE兼容性问题，不过IE早晚淘汰的玩意儿。 &lt;!docType html&gt; &lt;html&gt; &lt;head&gt; &lt;style type=&quot;text/css&quot...","link":"","photos":[],"count_time":{"symbolsCount":"2.7k","symbolsTime":"2 mins."},"categories":[{"name":"技术","slug":"技术","count":7,"path":"api/categories/技术.json"}],"tags":[{"name":"JS DOM","slug":"JS-DOM","count":3,"path":"api/tags/JS-DOM.json"}],"author":{"name":"Lu-ckYoung","avatar":"https://JS-DOM标准事件的三个阶段-blog.csdnimg.cn/20210313122054101.png","link":""}}}